# Device Registry - IoT Node Configuration
# Defines all devices in the Imperium network with their capabilities and profiles

devices:
  # Temperature Sensors
  node-1:
    type: temperature_sensor
    description: "Primary temperature sensor - Server Room"
    capabilities:
      - mqtt
      - telemetry
      - prometheus_metrics
    qos_profile: high_priority
    priority_level: 9
    default_sampling_rate: 5 # seconds
    mqtt_topics:
      data: "iot/node-1/data"
      control: "iot/node-1/control"
      status: "iot/node-1/status"
    network:
      max_bandwidth: "10mbps"
      min_latency: "50ms"
    location: "rack-A-1"

  node-2:
    type: temperature_sensor
    description: "Secondary temperature sensor - Storage Area"
    capabilities:
      - mqtt
      - telemetry
    qos_profile: medium_priority
    priority_level: 5
    default_sampling_rate: 10
    mqtt_topics:
      data: "iot/node-2/data"
      control: "iot/node-2/control"
      status: "iot/node-2/status"
    network:
      max_bandwidth: "5mbps"
      min_latency: "100ms"
    location: "storage-B-2"

  # CO2 Sensors (Air Quality)
  mhz19-01:
    type: co2_sensor
    model: MH-Z19B
    description: "MH-Z19 CO2 sensor - Lab environment monitoring"
    capabilities:
      - mqtt
      - co2_monitoring
      - temperature
      - calibration
      - prometheus_metrics
    qos_profile: high_priority
    priority_level: 8
    default_sampling_rate: 5  # seconds
    mqtt_topics:
      telemetry: "imperium/devices/mhz19-01/telemetry"
      config: "imperium/devices/mhz19-01/config"
      status: "imperium/devices/mhz19-01/status"
    network:
      max_bandwidth: "1mbps"
      min_latency: "200ms"
    sensor_specs:
      measurement_range: "0-5000 ppm"
      accuracy: "±50ppm + 5%"
      warmup_time: "3 minutes"
    location: "lab-1"
    alerts:
      high_co2: 1000
      critical_co2: 2000

  esp32-mhz19-1:
    type: co2_sensor
    model: MH-Z19B
    description: "ESP32 with MH-Z19 CO2 sensor - Indoor air quality monitoring"
    capabilities:
      - mqtt
      - co2_monitoring
      - temperature
      - calibration
      - prometheus_metrics
    qos_profile: high_priority
    priority_level: 8
    default_publish_interval: 5000 # milliseconds
    mqtt_topics:
      telemetry: "imperium/devices/esp32-mhz19-1/telemetry"
      control: "imperium/devices/esp32-mhz19-1/control"
      config: "imperium/devices/esp32-mhz19-1/config"
      status: "imperium/devices/esp32-mhz19-1/status"
    network:
      max_bandwidth: "1mbps"
      min_latency: "200ms"
    sensor_specs:
      measurement_range: "0-5000 ppm"
      accuracy: "±50ppm + 5%"
      warmup_time: "3 minutes"
      response_time: "< 60 seconds"
      detection_ranges:
        - 2000
        - 5000
        - 10000
      abc_logic: enabled
    location: "office-main"
    alerts:
      high_co2: 1000  # ppm - ventilation recommended
      critical_co2: 2000  # ppm - immediate action required

  # Environmental Sensors (Combined CO2 + Audio)
  esp32-env-1:
    type: environmental_sensor
    description: "ESP32 Environmental Node - MH-Z19 CO2 + INMP441 Audio"
    capabilities:
      - mqtt
      - co2_monitoring
      - audio_monitoring
      - temperature
      - prometheus_metrics
      - policy_control
    qos_profile: high_priority
    priority_level: 8
    default_publish_interval: 5000 # milliseconds
    mqtt_topics:
      telemetry: "imperium/devices/esp32-env-1/telemetry"
      control: "imperium/devices/esp32-env-1/control"
      config: "imperium/devices/esp32-env-1/config"
      status: "imperium/devices/esp32-env-1/status"
      audio: "imperium/devices/esp32-env-1/audio"
    network:
      max_bandwidth: "2mbps"
      min_latency: "150ms"
      metrics_port: 8080
    sensor_specs:
      co2:
        measurement_range: "0-5000 ppm"
        accuracy: "±50ppm + 5%"
        warmup_time: "3 minutes"
      audio:
        sample_rate: 16000
        channels: 1
        bits_per_sample: 16
        noise_threshold: -30 # dB
    location: "office-main"
    alerts:
      high_co2: 1000
      critical_co2: 2000
      noise_detected: -30 # dB threshold

  # Audio Sensors
  esp32-audio-1:
    type: audio_sensor
    description: "ESP32 with I2S microphone - Audio capture node"
    capabilities:
      - mqtt
      - audio_stream
      - prometheus_metrics
      - policy_control
    qos_profile: high_priority
    priority_level: 8
    default_sampling_rate: 16000 # Hz (audio sample rate)
    mqtt_topics:
      audio: "iot/esp32-audio-1/audio"
      telemetry: "iot/esp32-audio-1/telemetry"
      control: "iot/esp32-audio-1/control"
      status: "iot/esp32-audio-1/status"
      metadata: "iot/esp32-audio-1/metadata"
    network:
      ip_address: "10.218.189.218"
      max_bandwidth: "500kbps"
      min_latency: "100ms"
      metrics_port: 8080
    audio_config:
      channels: 1
      bits_per_sample: 16
      frame_size: 480 # samples per frame
      buffer_count: 4
    location: "raspberry-pi-network"

  # ESP32-CAM Devices
  esp32-cam-1:
    type: camera
    description: "ESP32-CAM with OV2640 - Image capture node"
    capabilities:
      - mqtt
      - image_capture
      - prometheus_metrics
      - policy_control
    qos_profile: high_priority
    priority_level: 8
    default_resolution: "SVGA" # 800x600
    default_quality: 10 # JPEG quality (0-63, lower is better)
    default_brightness: 0 # -2 to 2
    default_capture_interval: 5000 # ms (5 seconds)
    mqtt_topics:
      images: "iot/esp32-cam-1/images"
      telemetry: "iot/esp32-cam-1/telemetry"
      control: "iot/esp32-cam-1/control"
      status: "iot/esp32-cam-1/status"
    network:
      ip_address: "10.218.189.xxx" # Will be assigned via DHCP
      max_bandwidth: "1mbps"
      min_latency: "200ms"
      metrics_port: 8080
    camera_config:
      resolutions:
        - "QVGA"   # 320x240
        - "VGA"    # 640x480
        - "SVGA"   # 800x600 (default)
        - "XGA"    # 1024x768
        - "HD"     # 1280x720
        - "SXGA"   # 1280x1024
        - "UXGA"   # 1600x1200
      quality_range: [0, 63]
      brightness_range: [-2, 2]
      min_capture_interval: 100 # ms (10 FPS max)
      max_capture_interval: 60000 # ms (1 frame per minute min)
    location: "raspberry-pi-network"

  # Simulated Cameras
  camera-1:
    type: camera
    description: "Security camera - Main entrance"
    capabilities:
      - mqtt
      - video_stream
      - motion_detection
    qos_profile: bandwidth_limited
    priority_level: 7
    default_sampling_rate: 1 # FPS control
    mqtt_topics:
      data: "iot/camera-1/stream"
      control: "iot/camera-1/control"
      status: "iot/camera-1/status"
    network:
      max_bandwidth: "2mbps" # Throttled for bandwidth conservation
      min_latency: "200ms"
    location: "entrance-main"

  camera-2:
    type: camera
    description: "Security camera - Parking lot"
    capabilities:
      - mqtt
      - video_stream
    qos_profile: low_priority
    priority_level: 3
    default_sampling_rate: 1
    mqtt_topics:
      data: "iot/camera-2/stream"
      control: "iot/camera-2/control"
      status: "iot/camera-2/status"
    network:
      max_bandwidth: "1mbps"
      min_latency: "500ms"
    location: "parking-lot"

  # Environmental Sensors
  env-sensor-1:
    type: environmental_sensor
    description: "Multi-sensor - Humidity, Pressure, Air Quality"
    capabilities:
      - mqtt
      - telemetry
      - multi_sensor
      - prometheus_metrics
    qos_profile: medium_priority
    priority_level: 6
    default_sampling_rate: 15
    mqtt_topics:
      data: "iot/env-sensor-1/data"
      control: "iot/env-sensor-1/control"
      status: "iot/env-sensor-1/status"
    network:
      max_bandwidth: "5mbps"
      min_latency: "150ms"
    location: "office-floor-2"

  # Motion Sensors
  motion-1:
    type: motion_sensor
    description: "PIR motion detector - Hallway"
    capabilities:
      - mqtt
      - event_based
      - low_power
    qos_profile: event_driven
    priority_level: 8
    default_sampling_rate: 0 # Event-based, not periodic
    mqtt_topics:
      data: "iot/motion-1/events"
      control: "iot/motion-1/control"
      status: "iot/motion-1/status"
    network:
      max_bandwidth: "1mbps"
      min_latency: "50ms" # Low latency for security
    location: "hallway-floor-1"

# QoS Profiles Definition
qos_profiles:
  high_priority:
    mqtt_qos: 2 # Exactly once delivery
    priority: 9
    max_latency_ms: 50
    min_throughput_mbps: 1

  medium_priority:
    mqtt_qos: 1 # At least once delivery
    priority: 5
    max_latency_ms: 150
    min_throughput_mbps: 0.5

  low_priority:
    mqtt_qos: 0 # At most once delivery
    priority: 2
    max_latency_ms: 500
    min_throughput_mbps: 0.1

  bandwidth_limited:
    mqtt_qos: 1
    priority: 4
    max_latency_ms: 200
    max_bandwidth_mbps: 2 # Hard limit

  event_driven:
    mqtt_qos: 2
    priority: 8
    max_latency_ms: 50
    burst_mode: true

# Device Type Definitions
device_types:
  temperature_sensor:
    default_metrics:
      - temperature
      - timestamp
    sampling_rate_range: [1, 60] # seconds

  camera:
    default_metrics:
      - frame_rate
      - resolution
      - bandwidth_usage
    sampling_rate_range: [1, 30] # FPS

  environmental_sensor:
    default_metrics:
      - humidity
      - pressure
      - air_quality
      - temperature
    sampling_rate_range: [5, 300]

  motion_sensor:
    default_metrics:
      - motion_detected
      - last_trigger_time
    event_based: true
