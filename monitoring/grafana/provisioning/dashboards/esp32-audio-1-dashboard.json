{
  "uid": "esp32-audio-1",
  "title": "ESP32 Audio Node (esp32-audio-1)",
  "tags": ["esp32", "audio", "inmp441", "hardware"],
  "timezone": "browser",
  "schemaVersion": 38,
  "version": 1,
  "refresh": "5s",
  "editable": true,
  "time": {"from": "now-30m", "to": "now"},
  "panels": [
    {
      "id": 1,
      "title": "Device Status",
      "type": "stat",
      "gridPos": {"x": 0, "y": 0, "w": 6, "h": 4},
      "datasource": {"type": "prometheus", "uid": "ffaxnsjzvkkjkf"},
      "targets": [{"expr": "audio_sensor_online{device=\"esp32-audio-1\"}", "legendFormat": "Online", "refId": "A"}],
      "fieldConfig": {
        "defaults": {
          "mappings": [
            {"type": "value", "options": {"0": {"text": "OFFLINE", "color": "red"}}},
            {"type": "value", "options": {"1": {"text": "ONLINE", "color": "green"}}}
          ],
          "thresholds": {"mode": "absolute", "steps": [{"color": "red", "value": null}, {"color": "green", "value": 1}]}
        }
      }
    },
    {
      "id": 2,
      "title": "Audio Level",
      "type": "gauge",
      "gridPos": {"x": 6, "y": 0, "w": 6, "h": 8},
      "datasource": {"type": "prometheus", "uid": "ffaxnsjzvkkjkf"},
      "targets": [{"expr": "audio_rms_level_db{device=\"esp32-audio-1\"}", "legendFormat": "dB", "refId": "A"}],
      "fieldConfig": {
        "defaults": {
          "unit": "dB", "min": -80, "max": 0,
          "thresholds": {"mode": "absolute", "steps": [
            {"color": "green", "value": null}, {"color": "yellow", "value": -40},
            {"color": "orange", "value": -20}, {"color": "red", "value": -10}
          ]}
        }
      }
    },
    {
      "id": 3,
      "title": "Gain Multiplier",
      "type": "stat",
      "gridPos": {"x": 12, "y": 0, "w": 6, "h": 4},
      "datasource": {"type": "prometheus", "uid": "ffaxnsjzvkkjkf"},
      "targets": [{"expr": "audio_gain_multiplier{device=\"esp32-audio-1\"}", "legendFormat": "Gain", "refId": "A"}],
      "fieldConfig": {
        "defaults": {
          "unit": "x",
          "thresholds": {"mode": "absolute", "steps": [
            {"color": "green", "value": null}, {"color": "yellow", "value": 4}, {"color": "red", "value": 8}
          ]}
        }
      }
    },
    {
      "id": 4,
      "title": "Peak Amplitude",
      "type": "stat",
      "gridPos": {"x": 18, "y": 0, "w": 6, "h": 4},
      "datasource": {"type": "prometheus", "uid": "ffaxnsjzvkkjkf"},
      "targets": [{"expr": "audio_peak_amplitude{device=\"esp32-audio-1\"}", "legendFormat": "Peak", "refId": "A"}],
      "fieldConfig": {
        "defaults": {
          "thresholds": {"mode": "absolute", "steps": [
            {"color": "green", "value": null}, {"color": "yellow", "value": 0.5}, {"color": "red", "value": 0.9}
          ]}
        }
      }
    },
    {
      "id": 5,
      "title": "Publish Interval",
      "type": "stat",
      "gridPos": {"x": 0, "y": 4, "w": 6, "h": 4},
      "datasource": {"type": "prometheus", "uid": "ffaxnsjzvkkjkf"},
      "targets": [{"expr": "audio_publish_interval_ms{device=\"esp32-audio-1\"}/1000", "legendFormat": "Interval", "refId": "A"}],
      "fieldConfig": {"defaults": {"unit": "s", "thresholds": {"mode": "absolute", "steps": [{"color": "green", "value": null}]}}}
    },
    {
      "id": 6,
      "title": "Audio Level Over Time",
      "type": "timeseries",
      "gridPos": {"x": 0, "y": 8, "w": 12, "h": 8},
      "datasource": {"type": "prometheus", "uid": "ffaxnsjzvkkjkf"},
      "targets": [{"expr": "audio_rms_level_db{device=\"esp32-audio-1\"}", "legendFormat": "RMS (dB)", "refId": "A"}],
      "fieldConfig": {
        "defaults": {
          "unit": "dB",
          "custom": {"drawStyle": "line", "lineInterpolation": "smooth", "fillOpacity": 20, "lineWidth": 2},
          "thresholds": {"mode": "absolute", "steps": [
            {"color": "green", "value": null}, {"color": "yellow", "value": -40}, {"color": "red", "value": -20}
          ]}
        }
      }
    },
    {
      "id": 7,
      "title": "Noise Events Over Time",
      "type": "timeseries",
      "gridPos": {"x": 12, "y": 8, "w": 12, "h": 8},
      "datasource": {"type": "prometheus", "uid": "ffaxnsjzvkkjkf"},
      "targets": [{"expr": "rate(audio_noise_events_total{device=\"esp32-audio-1\"}[1m])*60", "legendFormat": "Events/min", "refId": "A"}],
      "fieldConfig": {"defaults": {"unit": "short", "custom": {"drawStyle": "bars", "fillOpacity": 80, "lineWidth": 0}}}
    },
    {
      "id": 8,
      "title": "MQTT Messages",
      "type": "stat",
      "gridPos": {"x": 12, "y": 4, "w": 6, "h": 4},
      "datasource": {"type": "prometheus", "uid": "ffaxnsjzvkkjkf"},
      "targets": [{"expr": "audio_messages_published_total{device=\"esp32-audio-1\"}", "legendFormat": "Messages", "refId": "A"}],
      "fieldConfig": {"defaults": {"unit": "short", "thresholds": {"mode": "absolute", "steps": [{"color": "green", "value": null}]}}}
    },
    {
      "id": 9,
      "title": "QoS Level",
      "type": "stat",
      "gridPos": {"x": 18, "y": 4, "w": 6, "h": 4},
      "datasource": {"type": "prometheus", "uid": "ffaxnsjzvkkjkf"},
      "targets": [{"expr": "audio_qos_level{device=\"esp32-audio-1\"}", "legendFormat": "QoS", "refId": "A"}],
      "fieldConfig": {"defaults": {"thresholds": {"mode": "absolute", "steps": [{"color": "green", "value": null}]}}}
    },
    {
      "id": 10,
      "title": "Frames Captured",
      "type": "stat",
      "gridPos": {"x": 0, "y": 16, "w": 8, "h": 4},
      "datasource": {"type": "prometheus", "uid": "ffaxnsjzvkkjkf"},
      "targets": [{"expr": "audio_frames_captured_total{device=\"esp32-audio-1\"}", "legendFormat": "Frames", "refId": "A"}],
      "fieldConfig": {"defaults": {"unit": "short", "thresholds": {"mode": "absolute", "steps": [{"color": "green", "value": null}]}}}
    },
    {
      "id": 11,
      "title": "Noise Events Total",
      "type": "stat",
      "gridPos": {"x": 8, "y": 16, "w": 8, "h": 4},
      "datasource": {"type": "prometheus", "uid": "ffaxnsjzvkkjkf"},
      "targets": [{"expr": "audio_noise_events_total{device=\"esp32-audio-1\"}", "legendFormat": "Events", "refId": "A"}],
      "fieldConfig": {"defaults": {"unit": "short", "thresholds": {"mode": "absolute", "steps": [{"color": "green", "value": null}, {"color": "yellow", "value": 100}]}}}
    },
    {
      "id": 12,
      "title": "Sample Rate",
      "type": "stat",
      "gridPos": {"x": 16, "y": 16, "w": 8, "h": 4},
      "datasource": {"type": "prometheus", "uid": "ffaxnsjzvkkjkf"},
      "targets": [{"expr": "audio_sample_rate_hz{device=\"esp32-audio-1\"}", "legendFormat": "Rate", "refId": "A"}],
      "fieldConfig": {"defaults": {"unit": "hertz", "thresholds": {"mode": "absolute", "steps": [{"color": "green", "value": null}]}}}
    }
  ]
}
